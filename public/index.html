<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Spidy Radio On Chat</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');

body { 
  background: radial-gradient(circle at top, #0a0f2c, #000); 
  font-family: 'Orbitron', monospace; 
  color: #ff0000; 
  display: flex; 
  justify-content: center; 
  align-items: center; 
  height: 100vh;
  overflow: hidden;
}

/* Snowflake animation */
body::before {
  content: '?';
  position: absolute;
  top: -10%;
  left: 50%;
  font-size: 2rem;
  color: #fff;
  animation: snow 10s linear infinite;
}
@keyframes snow {
  0% { transform: translateY(0) translateX(0); }
  100% { transform: translateY(110vh) translateX(100px); }
}

.console { 
  width: 500px; 
  border: 3px solid #ff0000; 
  border-radius: 16px; 
  padding: 16px; 
  box-shadow: 0 0 30px #ff000055, 0 0 50px #0066ff55 inset; 
  background: rgba(0,0,0,0.85);
  backdrop-filter: blur(4px);
}

.title { 
  text-align: center; 
  font-size: 20px; 
  letter-spacing: 3px; 
  margin-bottom: 12px;
  color: #ff0000;
  text-shadow: 0 0 6px #ff0000, 0 0 12px #0066ff;
}

#chat { 
  height: 280px; 
  overflow-y: auto; 
  background: #000; 
  border: 1px solid #00ffff44; 
  padding: 10px; 
  font-size: 14px; 
  white-space: pre-wrap; 
  margin-bottom: 12px;
  box-shadow: inset 0 0 10px #ff0000aa, inset 0 0 20px #0066ffaa;
}

.controls { 
  display: flex; 
  gap: 8px; 
}

input { 
  flex: 1; 
  background: #020818; 
  border: 1px solid #ff000088; 
  color: #00ffff; 
  padding: 10px; 
  font-family: inherit; 
  outline: none;
  border-radius: 6px;
}

button { 
  background: linear-gradient(45deg, #ff0000, #0066ff); 
  border: none; 
  color: #fff; 
  padding: 10px 16px; 
  font-weight: bold; 
  cursor: pointer; 
  border-radius: 8px;
  text-shadow: 0 0 4px #000;
  transition: all 0.2s;
}
button:hover { 
  box-shadow: 0 0 15px #ff0000aa, 0 0 25px #0066ffaa; 
  transform: scale(1.05);
}
</style>
</head>

<body>
<div class="console">
  <div class="title">Spidy Radio on Chat</div>
  <div id="chat"></div>

  <div class="controls">
    <input id="username" placeholder="Enter your hero name…" />
    <input id="msg" placeholder="Transmit message…" />
    <button onclick="send()">??? SEND</button>
  </div>
</div>

<script>
const chat = document.getElementById("chat");

// Automatically select WS URL based on environment
const LOCAL = window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1";
const PORT = 10000;
const wsUrl = LOCAL ? `ws://localhost:${PORT}` : `wss://${window.location.hostname}`;
const ws = new WebSocket(wsUrl);

ws.onmessage = e => {
  const data = JSON.parse(e.data);
  const time = new Date(data.time).toLocaleTimeString();
  chat.textContent += `[${time}] ${data.user}: ${data.message}\n`;
  chat.scrollTop = chat.scrollHeight;
};

function send() {
  const username = document.getElementById("username").value.trim() || "Anon";
  const message = document.getElementById("msg").value.trim();
  if (!message) return;
  ws.send(JSON.stringify({ user: username, message }));
  document.getElementById("msg").value = "";
}
</script>
</body>
</html>
